{"version":3,"file":"react-svg.cjs.production.js","sources":["../compiled/shallow-differs.js","../compiled/index.js"],"sourcesContent":["// Hat-tip: https://github.com/developit/preact-compat/blob/master/src/index.js#L402.\nconst shallowDiffers = (a, b) => {\n    for (const i in a) {\n        if (!(i in b)) {\n            return true;\n        }\n    }\n    for (const i in b) {\n        if (a[i] !== b[i]) {\n            return true;\n        }\n    }\n    return false;\n};\nexport default shallowDiffers;\n","import { SVGInjector } from '@tanem/svg-injector';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport shallowDiffers from './shallow-differs';\nexport default class ReactSVG extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.initialState = {\n            hasError: false,\n            isLoading: true\n        };\n        this.state = this.initialState;\n        this._isMounted = false;\n        this.refCallback = (container) => {\n            this.container = container;\n        };\n    }\n    renderSVG() {\n        if (this.container instanceof Node) {\n            const { evalScripts, renumerateIRIElements, src, svgClassName, svgStyle } = this.props;\n            /* eslint-disable @typescript-eslint/no-non-null-assertion */\n            const onInjected = this.props.onInjected;\n            const Wrapper = this.props.wrapper;\n            /* eslint-enable @typescript-eslint/no-non-null-assertion */\n            const wrapper = document.createElement(Wrapper);\n            wrapper.innerHTML = ReactDOMServer.renderToStaticMarkup(React.createElement(Wrapper, null,\n                React.createElement(Wrapper, { className: svgClassName, \"data-src\": src, style: svgStyle })));\n            this.svgWrapper = this.container.appendChild(wrapper.firstChild);\n            const each = (error, svg) => {\n                if (error) {\n                    this.removeSVG();\n                }\n                // TODO: It'd be better to cleanly unsubscribe from SVGInjector\n                // callbacks instead of tracking a property like this.\n                if (this._isMounted) {\n                    this.setState(() => ({\n                        hasError: !!error,\n                        isLoading: false\n                    }), () => {\n                        onInjected(error, svg);\n                    });\n                }\n            };\n            SVGInjector(this.svgWrapper.firstChild, {\n                each,\n                evalScripts,\n                renumerateIRIElements\n            });\n        }\n    }\n    removeSVG() {\n        if (this.container instanceof Node && this.svgWrapper instanceof Node) {\n            this.container.removeChild(this.svgWrapper);\n            this.svgWrapper = null;\n        }\n    }\n    componentDidMount() {\n        this._isMounted = true;\n        this.renderSVG();\n    }\n    componentDidUpdate(prevProps) {\n        if (shallowDiffers(prevProps, this.props)) {\n            this.setState(() => this.initialState, () => {\n                this.removeSVG();\n                this.renderSVG();\n            });\n        }\n    }\n    componentWillUnmount() {\n        this._isMounted = false;\n        this.removeSVG();\n    }\n    render() {\n        /* eslint-disable @typescript-eslint/no-unused-vars */\n        const { evalScripts, fallback: Fallback, loading: Loading, onInjected, renumerateIRIElements, src, svgClassName, svgStyle, wrapper, ...rest } = this.props;\n        /* eslint-enable @typescript-eslint/no-unused-vars */\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const Wrapper = wrapper;\n        return (React.createElement(Wrapper, Object.assign({}, rest, { ref: this.refCallback }),\n            this.state.isLoading && Loading && React.createElement(Loading, null),\n            this.state.hasError && Fallback && React.createElement(Fallback, null)));\n    }\n}\nReactSVG.defaultProps = {\n    evalScripts: 'never',\n    fallback: null,\n    loading: null,\n    onInjected: () => undefined,\n    renumerateIRIElements: true,\n    svgClassName: null,\n    svgStyle: {},\n    wrapper: 'div'\n};\nReactSVG.propTypes = {\n    evalScripts: PropTypes.oneOf(['always', 'once', 'never']),\n    fallback: PropTypes.oneOfType([\n        PropTypes.func,\n        PropTypes.object,\n        PropTypes.string\n    ]),\n    loading: PropTypes.oneOfType([\n        PropTypes.func,\n        PropTypes.object,\n        PropTypes.string\n    ]),\n    onInjected: PropTypes.func,\n    renumerateIRIElements: PropTypes.bool,\n    src: PropTypes.string.isRequired,\n    svgClassName: PropTypes.string,\n    svgStyle: PropTypes.object,\n    wrapper: PropTypes.oneOf(['div', 'span'])\n};\n"],"names":["shallowDiffers","a","b","i","ReactSVG","arguments","initialState","hasError","isLoading","state","_this","_isMounted","refCallback","container","renderSVG","this","Node","props","evalScripts","renumerateIRIElements","src","svgClassName","svgStyle","onInjected","Wrapper","wrapper","document","createElement","innerHTML","ReactDOMServer","renderToStaticMarkup","React","className","style","svgWrapper","appendChild","firstChild","SVGInjector","each","error","svg","_this2","removeSVG","setState","removeChild","componentDidMount","componentDidUpdate","prevProps","_this3","componentWillUnmount","render","Fallback","fallback","Loading","loading","rest","Object","assign","ref","defaultProps"],"mappings":"iaACMA,eAAiB,SAACC,EAAGC,OAClB,IAAMC,KAAKF,OACNE,KAAKD,UACA,MAGV,IAAMC,KAAKD,KACRD,EAAEE,KAAOD,EAAEC,UACJ,SAGR,GCPUC,8DAEJC,kBACJC,aAAe,CAChBC,UAAU,EACVC,WAAW,KAEVC,MAAQC,EAAKJ,eACbK,YAAa,IACbC,YAAc,SAACC,KACXA,UAAYA,oDAGzBC,UAAA,yBACQC,KAAKF,qBAAqBG,KAAM,OAC4CD,KAAKE,MAAzEC,IAAAA,YAAaC,IAAAA,sBAAuBC,IAAAA,IAAKC,IAAAA,aAAcC,IAAAA,SAEzDC,EAAaR,KAAKE,MAAMM,WACxBC,EAAUT,KAAKE,MAAMQ,QAErBA,EAAUC,SAASC,cAAcH,GACvCC,EAAQG,UAAYC,eAAeC,qBAAqBC,oBAAoBP,EAAS,KACjFO,oBAAoBP,EAAS,CAAEQ,UAAWX,aAA0BD,EAAKa,MAAOX,WAC/EY,WAAanB,KAAKF,UAAUsB,YAAYV,EAAQW,YAgBrDC,wBAAYtB,KAAKmB,WAAWE,WAAY,CACpCE,KAhBS,SAACC,EAAOC,GACbD,GACAE,EAAKC,YAILD,EAAK9B,YACL8B,EAAKE,SAAS,iBAAO,CACjBpC,WAAYgC,EACZ/B,WAAW,IACX,WACAe,EAAWgB,EAAOC,MAM1BtB,YAAAA,EACAC,sBAAAA,QAIZuB,UAAA,WACQ3B,KAAKF,qBAAqBG,MAAQD,KAAKmB,sBAAsBlB,YACxDH,UAAU+B,YAAY7B,KAAKmB,iBAC3BA,WAAa,SAG1BW,kBAAA,gBACSlC,YAAa,OACbG,eAETgC,mBAAA,SAAmBC,cACX/C,eAAe+C,EAAWhC,KAAKE,aAC1B0B,SAAS,kBAAMK,EAAK1C,cAAc,WACnC0C,EAAKN,YACLM,EAAKlC,iBAIjBmC,qBAAA,gBACStC,YAAa,OACb+B,eAETQ,OAAA,iBAEoJnC,KAAKE,MAAtHkC,IAAVC,SAA6BC,IAATC,QAAkF7B,IAAAA,QAAY8B,8JAI/HxB,oBADQN,EACqB+B,OAAOC,OAAO,GAAIF,EAAM,CAAEG,IAAK3C,KAAKH,cACrEG,KAAKN,MAAMD,WAAa6C,GAAWtB,oBAAoBsB,EAAS,MAChEtC,KAAKN,MAAMF,UAAY4C,GAAYpB,oBAAoBoB,EAAU,WA5EvCpB,0BA+E7B4B,aAAe,CACpBzC,YAAa,QACbkC,SAAU,KACVE,QAAS,KACT/B,WAAY,aACZJ,uBAAuB,EACvBE,aAAc,KACdC,SAAU,GACVG,QAAS"}
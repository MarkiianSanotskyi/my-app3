{"version":3,"file":"react-svg.cjs.development.js","sources":["../compiled/shallow-differs.js","../compiled/index.js"],"sourcesContent":["// Hat-tip: https://github.com/developit/preact-compat/blob/master/src/index.js#L402.\nconst shallowDiffers = (a, b) => {\n    for (const i in a) {\n        if (!(i in b)) {\n            return true;\n        }\n    }\n    for (const i in b) {\n        if (a[i] !== b[i]) {\n            return true;\n        }\n    }\n    return false;\n};\nexport default shallowDiffers;\n","import { SVGInjector } from '@tanem/svg-injector';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport shallowDiffers from './shallow-differs';\nexport default class ReactSVG extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.initialState = {\n            hasError: false,\n            isLoading: true\n        };\n        this.state = this.initialState;\n        this._isMounted = false;\n        this.refCallback = (container) => {\n            this.container = container;\n        };\n    }\n    renderSVG() {\n        if (this.container instanceof Node) {\n            const { evalScripts, renumerateIRIElements, src, svgClassName, svgStyle } = this.props;\n            /* eslint-disable @typescript-eslint/no-non-null-assertion */\n            const onInjected = this.props.onInjected;\n            const Wrapper = this.props.wrapper;\n            /* eslint-enable @typescript-eslint/no-non-null-assertion */\n            const wrapper = document.createElement(Wrapper);\n            wrapper.innerHTML = ReactDOMServer.renderToStaticMarkup(React.createElement(Wrapper, null,\n                React.createElement(Wrapper, { className: svgClassName, \"data-src\": src, style: svgStyle })));\n            this.svgWrapper = this.container.appendChild(wrapper.firstChild);\n            const each = (error, svg) => {\n                if (error) {\n                    this.removeSVG();\n                }\n                // TODO: It'd be better to cleanly unsubscribe from SVGInjector\n                // callbacks instead of tracking a property like this.\n                if (this._isMounted) {\n                    this.setState(() => ({\n                        hasError: !!error,\n                        isLoading: false\n                    }), () => {\n                        onInjected(error, svg);\n                    });\n                }\n            };\n            SVGInjector(this.svgWrapper.firstChild, {\n                each,\n                evalScripts,\n                renumerateIRIElements\n            });\n        }\n    }\n    removeSVG() {\n        if (this.container instanceof Node && this.svgWrapper instanceof Node) {\n            this.container.removeChild(this.svgWrapper);\n            this.svgWrapper = null;\n        }\n    }\n    componentDidMount() {\n        this._isMounted = true;\n        this.renderSVG();\n    }\n    componentDidUpdate(prevProps) {\n        if (shallowDiffers(prevProps, this.props)) {\n            this.setState(() => this.initialState, () => {\n                this.removeSVG();\n                this.renderSVG();\n            });\n        }\n    }\n    componentWillUnmount() {\n        this._isMounted = false;\n        this.removeSVG();\n    }\n    render() {\n        /* eslint-disable @typescript-eslint/no-unused-vars */\n        const { evalScripts, fallback: Fallback, loading: Loading, onInjected, renumerateIRIElements, src, svgClassName, svgStyle, wrapper, ...rest } = this.props;\n        /* eslint-enable @typescript-eslint/no-unused-vars */\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const Wrapper = wrapper;\n        return (React.createElement(Wrapper, Object.assign({}, rest, { ref: this.refCallback }),\n            this.state.isLoading && Loading && React.createElement(Loading, null),\n            this.state.hasError && Fallback && React.createElement(Fallback, null)));\n    }\n}\nReactSVG.defaultProps = {\n    evalScripts: 'never',\n    fallback: null,\n    loading: null,\n    onInjected: () => undefined,\n    renumerateIRIElements: true,\n    svgClassName: null,\n    svgStyle: {},\n    wrapper: 'div'\n};\nReactSVG.propTypes = {\n    evalScripts: PropTypes.oneOf(['always', 'once', 'never']),\n    fallback: PropTypes.oneOfType([\n        PropTypes.func,\n        PropTypes.object,\n        PropTypes.string\n    ]),\n    loading: PropTypes.oneOfType([\n        PropTypes.func,\n        PropTypes.object,\n        PropTypes.string\n    ]),\n    onInjected: PropTypes.func,\n    renumerateIRIElements: PropTypes.bool,\n    src: PropTypes.string.isRequired,\n    svgClassName: PropTypes.string,\n    svgStyle: PropTypes.object,\n    wrapper: PropTypes.oneOf(['div', 'span'])\n};\n"],"names":["shallowDiffers","a","b","i","ReactSVG","arguments","initialState","hasError","isLoading","state","_isMounted","refCallback","container","renderSVG","Node","props","evalScripts","renumerateIRIElements","src","svgClassName","svgStyle","onInjected","Wrapper","wrapper","document","createElement","innerHTML","ReactDOMServer","renderToStaticMarkup","React","className","style","svgWrapper","appendChild","firstChild","each","error","svg","removeSVG","setState","SVGInjector","removeChild","componentDidMount","componentDidUpdate","prevProps","componentWillUnmount","render","Fallback","fallback","Loading","loading","rest","Object","assign","ref","defaultProps","undefined","propTypes","PropTypes","isRequired"],"mappings":"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"}